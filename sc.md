# 問1　サイバー攻撃への対策に関する次の記述を読んで、設問に答えよ。

C社は首都圏に複数の販売店をもつ，中堅の中古車販売会社である。<br>
C社はS県に複数の中古車販売店舗を展開するP社と業務提携しており、P社の中
古車情報もC社の販売管理システムに登録した上で販売を行っている。

## 〔C社販売管理システムの概要〕
［C社販売管理システムの概要〕
販売管理システムは、Webサーバ、アプリケーション（以下、APという）サーバ及
びデータベース（以下、DBという）サーバから成り、C社及びP社の販売店は、Web
サーバを経由して中古車情報や販売実績の登録を行う。C社の販売店の情報は、C社
内のPC（以下、PC-Cという）から，APサーバの販売店情報登録ツール（以下，販売
店ツールという）を利用して登録を行う。また，販売管理システムのWebサーバ、AP
サーバ及びDBサーバ（以下，C社各サーバという）のメンテナンスは，C社の社内シ
ステム担当が、社内システム用のPC（以下、PG-Sという）から管理者権限のあるID
（以下，特権IDという）でC社各サーバにログインして実施している。<br>
P社の販売店の情報は、P社従業員が、社内に設置したP社販売店情報登録用のPC
（以下、PC-Pという）から、C社内に設置したP社販売店情報登録用のPC（以下、
PC-Rという）にリモートデスクトップでログインし、販売店ツールを利用して登録
を行う。P社は、P社従業員の自宅PC（以下、自宅PCという）からSSL-VPNを利用し
て、PC-Pにリモートデスクトップでログインできる環境を構築している。<br>
C社及びP社のネットワーク構成（抜粋）を図1に示す。

<table>
<caption>C社及びP社のネットワーク構成（抜粋）</caption>
<tr>
<td>![図1　C社及びP社のネットワーク構成（抜粋）](image1)</td>
</tr>
<tr>
<td>FW：ファイアウォール</td>
</tr>
<tr>
<td>
(参考：図中の語句)<br>
C社

DMZセグメント
Webサーバ

バックアップセグメント
NAS

FW1

業務セグメント
APサーバ
DBサーバ
PCーC
PC-S
PC-R

FW2

インターネット

C社販売店
販売店PC

P社販売店
販売店PC

P社従業員自宅
自宅PC

広域イーサネット

P社
VPNルータ
FW3
業務セグメント
PC-P

</td>
</tr>
</table>
C社FW1,FW2及びP社FW3の許可ルール（抜粋）を表1に示す。
<table>
<caption>表1　C社FW1,FW2及びP社FW3の許可ルール（抜粋）</caption>
<thead><tr><th>機器</th><th>送信元</th><th>送信先</th><th>プロトコル/ポート番号</th></tr></thead>
<tr><td>FW1</td><td>インターネット</td><td>DMZセグメント</td><td>TCP/443(HTTPS)</td></tr>
<tr><td>FW1</td><td>Webサーバ</td><td>APサーバ</td><td>TCP/80(HTTP)</td></tr>
<tr><td>FW1</td><td>Webサーバ</td><td>バックアップセグメント</td><td>TCP/22(SSH)</td></tr>
<tr><td>FW1</td><td>APサーバ,DBサーバ</td><td>バックアップセグメント</td><td>TCP/22(SSH)</td></tr>
<tr><td>FW2</td><td>P社の業務セグメント</td><td>C社の業務セグメント</td><td>TCP/3389(RDP)</td></tr>
<tr><td>FW3</td><td>P社の業務セグメント</td><td>C社の業務セグメント</td><td>TCP/3389(RDP)</td></tr>
<tr><tdcolspan="4">注記　FW1,FW及びFW3は、応答パケットを自動的に通過させる、ステートフルパケットインスペクション機能を持つ。</td></tr>
</table>

C社各サーバにはマルウェア対策ソフトウェアがインストールされている。C社各
サーバのデータは、毎日午前0時30分～午前1時30分の間にバックアップを行う。
月曜日にデータのフルバックアップを行い、火曜日から日曜日まではデータの差分
バックアップを行っている。NASには月曜日を起点として最大7日分のバックアップ
を1世代分保存しており、次の世代のデータは前の世代のデータに上書き保存される。
また，C社各サーバのシステムバックアップもNASに保存している。<br>
C社及びP社の各PC，各サーバ及びネットワーク機器のログは各機器内部に保存し
ており，ログのサイズが最大値に達した場合は、最も古い記録から上書きする設定
になっている。<br>
C社の各PC及び各サーバはログインのロックアウトのしきい値を5回に設定してい
る。

##〔セキュリティインシデントの発生〕
ある月曜日の午前9時頃，C社のシステム部門に，C社販売店から販売管理システ
ムが利用できないとの報告があった。システム部門のR主任が販売管理システムを調
査したところ、C社各サーバのデータが暗号化されていることが判明した。<br>
R主任は外部のセキュリティ会社であるU社に連絡してインシデントの調査を依頼
した。U社の✕氏から“<u>①電磁的記録の証拠保全、調査及び分析</u>を行うので、C社内
のインターネットと広域イーサネットに接続しているネットワークを遮断した後、
全てのPCの使用を停止してください”との要請があり、R主任は要請に従った。

##〔セキュリティインシデントの調査〕

X氏から"PC, サーバ及びネットワーク機器のログを分析した結果、侵入者は次の(1)〜(4)の順序で攻撃したことが判明した"と報告があった。
1. インシデントの報告日の午前3時15分に、PC-PからPC-Rにログインした。
2. PC-Rと同じパスワードのログインIDがPC-Sに存在していた。PC-Rのログインに利用したパスワードで、PC-Sにリバースブルートフォース攻撃を行い、PC-Sにログインした。
3. "社内システム担当がサーバにログインする際に利用したIDとパスワードを、PC-Sのメモリ上に保存してしまう"というPC-SのAPソフトウェアの脆弱性を利用して、C社各サーバにログインした。
4. C社各サーバのマルウェア対策ソフトウェアのプロセスを強制終了して、ランサムウェアを実行した。

✕氏は“侵入経路であるP社の機器もC社と同様に電磁的記録の証拠保全，調査及
び分析を行う必要があるので、P社へ連絡するように”とR主任に要請した。<br>
✕氏がPC-P及びP社のネットワーク機器を調査したところ、次の状況が判明した。<br>
- VPNルータには認証に関する脆弱性があった。
- 攻撃に利用されたPC-CのIDとパスワードはPC-Rと同一であった。
- PC-Pへは"administrator"のIDに対して異なるパスワードで約1万回ログインに失敗した後、"admin"のIDに対して異なるパスワードで150回ログインに失敗し、151回目でログインに成功していた。

✕氏は“侵入者はVPNルータの脆弱性を利用して、認証情報を取得した上でVPN接
続を行い、[ a ]攻撃を行い侵入した後、[ b ]でPC-Rへログインした可能性が高い。PC-Pのログインに関する設定がPC-Rと異なっていたので、[ a ]攻撃を防げずに侵入されたと推測される。"とR主任へ報告した。

## 〔暫定対応及びシステムの復旧〕

侵入経路と原因が判明したので、R主任及びP社は次の暫定対応を実施し、C社各
サーバのシステム及びデータをバックアップデータから復旧の上，販売管理システ
ムの利用を再開した。
- VPNルータとPC-SのAPソフトウェアに、脆弱性に対応した修正プログラムを適用した。
- PC及びサーバのIDとパスワードを推測が困難で複雑なものへ変更した。
- <u>②今回と同様の攻撃を防御するために、PC-Pの設定を変更した。ただし、パスワードが漏えいし、リバースブルートフォース攻撃を受けた場合は、このPC-Pの設定変更では防御できないおそれがある</u>ので、PC-Rへのリモートデスクトップでのログインは、P社からの利用申請を受けてC社が許可したときだけ可能とするルールを設けることにした。

## 〔U社からC社への報告〕
U社はC社へ、C社の課題をまとめて報告した。C社の課題（抜粋）を表2に示す。

<table>
    <caption>表2　C社の課題</caption>
    <thead><tr><th>項番</th><th>課題</th></tr></thead>
    <tr><th>1</th><th>©社に接続するP社のPC及びネットワーク機器について、機器管理や弱性管理ができていない。</th></tr>
    <tr><th>2</th><th>侵入者が特権IDでログインし、今回のようにC社各サーバで操作を行った場合、マルウェアの検知ができなくなる。</th></tr>
    <tr><th>3</th><th>インシデントの報告日の前日にランサムウェアに感染して暗号化されていた場合、<u>③バックアップデータからの復旧に問題が生じたおそれがある</u>。また、NASに侵入されてバックアップデータが暗号化されるリスクもある。</th></tr>
    <tr><th>4</th><th>一定期間に大量の攻撃を受けた場合、<u>④過去に発生した事象が調査できなくなるおそれがある</u>。</th></tr>
</table>

## 〔課題に対する対策〕

R主任は、課題に対して次の対策案を検討した。

- 項番1の対策として、C社に接続するP社のPC及びネットワーク機器の情報をP社から提供してもらい、機器の一覧を作成する。また、P社に運用ルールの作成を依頼し、作成してもらった運用ルールが適切であることを確認する。
- 項番2の対策として、R主任を特権ID管理者とし、R主任が許可した場合だけ、特権IDを利用可能にする運用ルールを作成する。また、R主任が許可した場合には、特権IDにワンタイムパスワードを設定し、利用者に払い出す仕組みを導入する。
- 項番3の対策として、バックアップデータが暗号化されないように、NASに加えて[ c ]バックアップに対応したストレージにバックアップデータを保存する。また、バックアップデータは3世代分保存する。
- 項番4の対策として、ログサーバを設置し、PC、サーバ及びネットワーク機器のログを保存する。

R主任は、C社内の再発防止会議で対策案の報告を行い、対策案は承認された。

### 設問1
<table>
    <thead>
        <tr><th>小問の番号</th><th>問い</th><th>左列の「問い」の解答例または回答の要点</th></tr>
    </thead>
    <tr><th>1</th><th>本文中の下線①の調査方法の名称を、片仮名12字以内で答えよ。</th><th></th></tr>
</table>

### 設問2
<table>
    <thead>
        <tr><th>小問の番号</th><th>問い</th><th>左列の「問い」の解答例または回答の要点</th></tr>
    </thead>
    <tr><th>1</th><th>本文中の[ a ]に入れる適切な字句、本文中の[ b ]に入れる適切なプロトコル名をそれぞれ解答欄の中から選び、記号で答えよ。
    解答群：ア：HTTP イ：HTTPS ウ：RDP エ：SSH オ：辞書　カ：中間者　キ：パスワードスプレー　ク：リプレイ</th><th>a: b:</th></tr>
</table>

### 設問3
<table>
    <thead>
        <tr><th>小問の番号</th><th>問い</th><th>左列の「問い」の解答例または回答の要点</th></tr>
    </thead>
    <tr><th>1</th><th>本文中の下線②について、変更した設定項目を、本文中の軸を用いて15字以内で答えよ。また、防御できないおそれがある理由を、"同一"という字句を用いて25字以内で答えよ。</th><th></th></tr>
</table>

### 設問4
<table>
    <thead>
        <tr><th>小問の番号</th><th>問い</th><th>左列の「問い」の解答例または回答の要点</th></tr>
    </thead>
    <tr><th>1</th><th>表2中の下線③について、バックアップデータに発生したおそれがある現象を30字以内で答えよ。</th><th></th></tr>
    <tr><th>2</th><th>表2中の下線④について、調査ができなくなる理由を20字以内で答えよ。</th><th></th></tr>
</table>

### 設問5
<table>
    <thead>
        <tr><th>小問の番号</th><th>問い</th><th>左列の「問い」の解答例または回答の要点</th></tr>
    </thead>
    <tr><th>1</th><th>本文中の[ c ]に入れる適切な字句を解答欄から選び、記号で答えよ。　ア：イミュータブル　イ：インクリメンタル　ウ：ディファレンシャル　エ：マルチプル</th><th></th></tr>
</table>
